name: Build
description: Builds the composite action

inputs:
  dotnet-version:
    description: The version of .NET to use
    required: true
  dotnet-quality:
    description: The quality of .NET to use
    required: true
    default: stable
  solution-path:
    description: The path to the solution to build
    required: true
    default: ParusRX.sln
  projects-path:
    description: The path to the projects to build
    required: true

runs:
  using: composite
  steps:
    - name: Setup .NET
      uses: actions/setup-dotnet@v3
      with:
        dotnet-version: ${{ inputs.dotnet-version }}
        dotnet-quality: ${{ inputs.dotnet-quality }}
    - name: Restore dependencies
      shell: bash
      run: |
        dotnet restore ${{ inputs.solution-path }}
    - name: Build
      shell: bash
      working-directory: ${{ inputs.projects-path }}
      run: |
        for project in $(find . -name '*.csproj' -type f); do
          dotnet build $project --configuration Release --no-restore
        done
    